<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leaflet Theme Control - Basic Example</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href='data:image/svg+xml,<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M13 4c-5 0-9 4-9 9s4 9 9 9 9-4 9-9-4-9-9-9zm0 16V6c3.9 0 7 3.1 7 7s-3.1 7-7 7z" fill="%23333"/></svg>'
    />

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet.css" />

    <!-- Theme Control CSS -->
    <link rel="stylesheet" href="../src/leaflet-theme-control.css" />

    <!-- Import Map for ES Modules -->
    <script type="importmap">
      {
        "imports": {
          "leaflet": "https://unpkg.com/leaflet@2.0.0-alpha.1/dist/leaflet.js"
        }
      }
    </script>

    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      }

      #map {
        width: 100%;
        height: 100vh;
      }

      /* Info box basic styling - theming handled by applyToSelectors */
      .info-box {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        background: white;
        padding: 15px;
        border-radius: 5px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        max-width: 300px;
      }

      .info-box h2 {
        margin-top: 0;
        font-size: 18px;
      }

      .info-box p {
        margin: 5px 0;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <div class="info-box">
      <h2>üé® Leaflet Theme Control</h2>
      <p>Click the theme button to cycle through:</p>
      <ul style="margin: 5px 0; padding-left: 20px; font-size: 14px">
        <li>‚òÄÔ∏è Light</li>
        <li>üåô Dark</li>
        <li>‚ö´ Grayscale</li>
        <li>üé® Custom</li>
      </ul>
      <p style="font-size: 12px; color: #666">Your preference is saved automatically!</p>
    </div>

    <div id="map"></div>

    <script type="module">
      import { Map, TileLayer, Marker } from "leaflet";
      import { ThemeControl, DEFAULT_THEMES } from "../src/leaflet-theme-control.js";

      // Initialize map
      const map = new Map("map", {
        center: [51.505, -0.09],
        zoom: 13
      });

      // Add tile layer
      new TileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>'
      }).addTo(map);

      // Add some markers
      new Marker([51.5, -0.09]).addTo(map).bindPopup("A sample marker");

      new Marker([51.51, -0.1]).addTo(map).bindPopup("Another marker");

      // Add theme control with applyToSelectors for info-box
      const themeControl = new ThemeControl({
        position: "topright",
        themes: {
          ...DEFAULT_THEMES,
          // Add applyToSelectors to apply filter to info-box
          dark: {
            ...DEFAULT_THEMES.dark,
            applyToSelectors: ".info-box"
          },
          grayscale: {
            ...DEFAULT_THEMES.grayscale,
            applyToSelectors: ".info-box"
          },
          custom: {
            ...DEFAULT_THEMES.custom,
            applyToSelectors: ".info-box"
          }
        },
        onChange: (themeKey, theme) => {
          console.log("Theme changed to:", themeKey);
        }
      });

      themeControl.addTo(map);

      console.log("Initial theme:", themeControl.getCurrentTheme());
    </script>
  </body>
</html>
